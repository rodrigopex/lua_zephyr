sample:
  name: LittleFS Lua Sample
tests:
  sample.lua_zephyr.littlefs:
    harness: console
    extra_configs:
      - CONFIG_QEMU_ICOUNT=y
      - CONFIG_SHELL=n
      - CONFIG_LUA_FS_SHELL=n
      - CONFIG_LOG_MODE_MINIMAL=y
    harness_config:
      type: multi_line
      ordered: true
      regex:
        - "Bootstrap: writing scripts to LittleFS"
        - "Bootstrap: done"
        - "Hello from LittleFS!"
        - "Greetings from greet.lua!"
        - "dofile returned successfully"
        - "Lua Language Data:"
        - "language\\s+: Lua"
        - "file: greet.lua \\(\\d+ bytes\\)"
        - "file: hello_fs.lua \\(\\d+ bytes\\)"
        - "file: info.lua \\(\\d+ bytes\\)"
        - "heap:\\s+32768\\s+\\d+\\s+\\d+\\s+\\d+%"
        - "stack:\\s+\\d+\\s+\\d+\\s+\\d+\\s+\\d+%"
    tags: lua_zephyr
    integration_platforms:
      - qemu_x86
      - mps2/an385
